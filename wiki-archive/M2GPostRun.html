<!DOCTYPE html>
<html  xml:lang="en" lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>GlassFish Wiki : M2GPostRun</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta http-equiv="content-language" content="en" />
        <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet" />
        <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
        <link href="styles/docs.css" rel="stylesheet" />
        <link href="styles/site1.css" rel="stylesheet" />
        <style> a { color: #555555; } </style>
        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
                <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>

    <body class="page-documentation project-gfmvnsite" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <div class="brand"><a href="/glassfish/index.html"><img src="../images/gflogo24.png"><span style="color:#E88A43;font-size:18px;padding-left:11px;padding-top:15px;font-weight:bold;">GlassFish</span> - <span style="font-size:18px;" class="gf-grey">World's first Java EE 7 Application Server</span></a></div>
                    <div class="nav-collapse">
                        <ul class="nav pull-right">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
									<li><a href="/glassfish/LICENSE" title="License">Legal </a></li>
									<li><a href="/glassfish/CONTRIBUTING" title="Contributing">Contributing </a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>

        <br/><br/>
        <div class="container"><body> 
 <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff"> 
  <tbody>
   <tr> 
    <td valign="top" class="pagebody">   <h4><a name="M2GPostRun-PostMigrationActions"></a>Post Migration Actions</h1> <p>During migration, the Migration Tool puts modified files into the output directory you specified. You can manually make additional changes to the generated output to overcome the <a href="M2GLimitations.html" title="M2GLimitations">limitations</a> of the Migration Tool.<br> You need to complete the following post-migration procedures:</p> 
     <ul> 
      <li>Interpret the Migration Report, which provides hints about relevant actions you need to take</li> 
      <li>Manually Migrate Relevant Configuration Parameters that are listed in the <tt>&lt;server-name&gt;ConfigOut.txt</tt> file</li> 
      <li>Include the DBSCHEMA File/s Inside the JAR file</li> 
     </ul> <p> This step is valid only if the target is the Application Server and the migrated application contains CMP entity beans.</p> 
     <ul> 
      <li>Building the Migrated Application into a Deployable Unit by using scripts that are generated by the Migration Tool</li> 
      <li>Deploying the Built Unit to the Application Server</li> 
      <li>Troubleshooting the Building and Deployment Processes</li> 
     </ul> <h4><a name="M2GPostRun-InterprettheMigrationReport"></a>Interpret the Migration Report</h2> <p>The Migration Tool generates a Migration Report for each migration performed. This report provides insight into the state of the migrated application, explaining the "how" and "why" for the migration results. It also provides pointers to the next steps you need to perform to successfully deploy the migrated application. Press the "View Details" button on the Output Result from Automatic Migration screen to display the report. For more details, see the section on the Migration Report.</p> <h4><a name="M2GPostRun-ManuallyMigrateRelevantConfigurationParameters"></a>Manually Migrate Relevant Configuration Parameters</h2> <p>If input to the Migration Tool includes the <tt>weblogic.properties</tt>, <tt>server-cfg.xml</tt>, <tt>config.xml</tt>, <tt>resource.properties</tt>, <tt>regwin.dat</tt>, or <tt>reg.dat</tt> files, the DataSources and StartupClass configuration parameters for WebLogic 5.1/6.0/6.1 will be migrated after you run the Build Scripts Generated.<br> Your application may use the DataSources registered by the script. To do so, register the database drivers defined in the DataSources with the Application Server. The text file generated by the Migration Tool during compilation provides information for registering the database drivers and other configuration parameters, such as Thread Pool settings. The selected source and target application server determine the name of the text file.</p> 
     <div class="table-wrap"> 
      <table class="confluenceTable">
       <tbody> 
        <tr> 
         <th class="confluenceTh">Source Server </th> 
         <th class="confluenceTh">Generated File </th> 
         <th class="confluenceTh">&nbsp;</th> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> JBoss 3.0 </td> 
         <td class="confluenceTd"> <tt>JBoss30_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> WebLogic 5.1 </td> 
         <td class="confluenceTd"> <tt>WLS510_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> WebLogic 6.0 </td> 
         <td class="confluenceTd"> <tt>WLS6x_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> WebLogic 6.1 </td> 
         <td class="confluenceTd"> <tt>WLS6x_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> WebSphere 4.0 </td> 
         <td class="confluenceTd"> <tt>WASConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> Sun ONE App Server 6.x </td> 
         <td class="confluenceTd"> <tt>IAS65_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> J2EE RI 1.3 </td> 
         <td class="confluenceTd"> <tt>RI13_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
        <tr> 
         <td class="confluenceTd"> J2EE RI 1.4 </td> 
         <td class="confluenceTd"> <tt>RI14_J2EERIB2ConfigOut.txt</tt> </td> 
         <td class="confluenceTd">&nbsp;</td> 
        </tr> 
       </tbody>
      </table> 
     </div> <p>The paths of these files are defined in the Migration Report.</p> <h4><a name="M2GPostRun-IncludetheDBSCHEMAFile%2FsInsidetheJARfile"></a>Include the DBSCHEMA File/s Inside the JAR file</h2> <p>Note - This step is required only when the target server for migration is the Application Server and the JAR in question contains a CMP entity bean.<br> The DBSCHEMA file is an XML file, created by</p> 
     <ul> 
      <li>Using a utility inside the &lt;AS_HOME&gt;/bin, the DBSCHEMA file captures the database schema of the underlying database tables to which CMP entity beans declared inside the ejb-jar.xml are mapped. The migration generates the sun-cmp-mappings.xml file, which has a tag called "schema" that references the DBSCHEMA file. This schema tag contains the name and location of the DBSCHEMA file, relative to the parent directory of the <tt>META-INF</tt> directory. The Application Server uses the DBSCHEMA file at deployment time to generate the classes required to persist CMP entity beans.</li> 
     </ul> <p>The <tt>schema</tt> tag in the <tt>sun-cmp-mappings.xml</tt> file always contains the name "mySchema". You can replace this value with your DBSCHEMA file name (without the .dbschema extension). Otherwise, you can create the DBSCHEMA file with the name "mySchema".<br> The following two options are provided for including the DBSCHEMA file inside a JAR:</p> 
     <ul> 
      <li>Using an environment variable<br> Set the DBSCHEMAFP environment variable to the absolute path of the DBSCHEMA file. The referenced schema file is placed inside all the JARs that are created by the build scripts. Use this option only if all the CMP entity beans inside the application use the same database schema. Set the DBSCHEMAFP environment variable before running the build scripts.<br> On Windows: set DBSCHEMAFP = c:\mySchemas\mySchema.dbschema <br> On Solaris: export DBSCHEMAFP= /usr/schema/mySchema.dbschema </li> 
      <li>Copying the file into a particular directory</li> 
     </ul> <p> The DBSCHEMA file can be placed inside the directory that contains the build files that generate the JAR; for example, build_jar.xml, build_jar.cmd, build_jar.sh. When placed as such, the schema file is packaged only inside the JAR.Note - <br> If both options are used, the created JAR contains both schema files. If the schema files have the same name, the file copied inside the directory is be given priority over the file pointed to by the DBSCHEMAFP environment variable.</p> <h4><a name="M2GPostRun-BuildingtheMigratedApplicationintoaDeployableUnit"></a>Building the Migrated Application into a Deployable Unit</h2> <p>After you read the migration report, make any necessary remedial changes, and configure the Application Server according to the instructions in the <em>&lt;input-specific&gt;</em><tt>ConfigOut.txt</tt> file, you can build the application into a deployable unit (JAR, WAR, or EAR file) from the migrated source files. The Migration Tool automatically generates Build Scripts Generated as part of the migration process to automate the build process.<br> On Solaris, assuming that <tt>/migrated_output</tt> is the output directory in which the migrated source code is located, complete the following steps to build the migrated application into a deployable unit:<br> Change directory to <tt>/migrated_output</tt>.<br> Set the CLASSPATH environment variable to include all other JAR files or classes that the application code requires to compile.Note - <br> This is important because it is frequently a failure point when compiling the migrated source code. <br> Run the generated build script, <tt>build_</tt><em>xxx</em><tt>.sh</tt>, replacing the xxx with the deployable unit (JAR, WAR, or EAR) you want to be built. For example,</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">% _sh build_ear.sh_</pre> 
       </div> 
      </div>
     </div> <p> This initiates the automated build process of the application and creates a deployable unit in the <tt>migrated_output/asmtbuild</tt> directory.<br> On Windows, assuming that <tt>c:\migrated_output</tt> is the output directory in which the migrated source code is located, complete the following steps to build the migrated application into a deployable unit:<br> Change directory to <em>C:\migrated_output</em>.<br> Set the CLASSPATH environment variable to include all other JAR files or classes that the application code requires to compile.Note - <br> This is important because it is frequently a failure point when compiling the migrated source code. <br> If the deployment descriptors for both the JAR and WAR files are in the same directory, the current directory or a period (".") should not be in the CLASSPATH. This avoids any unnecessary packaging of class files inside the WAR file.<br> Run the generated build script, <tt>build_</tt><em>xxx</em>, replacing the <em>xxx</em> with the deployable unit (JAR, WAR, or EAR) you want to be built. For example,</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">PROMPT&gt; build_ear</pre> 
       </div> 
      </div>
     </div> <p> This initiates the automated build process of the application and creates a deployable unit in the <tt>C:\migrated_output\asmtbuild</tt> directory.</p> <h4><a name="M2GPostRun-DeployingtheBuiltUnittotheApplicationServer"></a>Deploying the Built Unit to the Application Server</h2> <p>After you build the migrated application into a deployable unit, you can deploy it to the Application Server:</p> 
     <ul> 
      <li>If the input is an EAR, WAR, or JAR file, the Migration Tool will automatically invoke the build scripts once it completes the migration process and places the built EAR file in the <em>&lt;output_directory&gt;</em><tt>/Input_Archives/asmtbuild</tt> directory. This EAR will only be built if the migration is successful.</li> 
     </ul> <p> The build may not be automatically created if: </p> 
     <ul> 
      <li>At least one file fails to migrate</li> 
      <li>The <a href="M2GInstSetup.html" title="M2GInstSetup">Installation and Setup</a> are inadequate.</li> 
      <li>On Solaris, where /migrated_output is the output directory in which the migrated source code is located and myunit{{.ear}} is the name of the deployable unit:</li> 
     </ul> <p> Change to the <tt>/migrated_output/asmtbuild</tt> directory.<br> Run the <tt>asadmin</tt> command to deploy the archive:</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">% asadmin deploy -u &lt;username&gt; --passwordfile &lt;passwordfile&gt; -H &lt;hostname&gt; -p &lt;adminport&gt; myunit.ear</pre> 
       </div> 
      </div>
     </div> 
     <ul> 
      <li>On Windows, where <tt>C:\migrated_output</tt> is the output directory in which the migrated source code is located and <tt>myunit.ear</tt> is the name of the deployable unit:</li> 
     </ul> <p> Change directory to C:\migrated_output\asmtbuild<br> Run the <tt>asadmin</tt> command to deploy the archive:</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">PROMPT&gt; asadmin deploy -u &lt;username&gt;
--passwordfile &lt;passwordfile&gt; -H &lt;hostname&gt;
-p &lt;adminport&gt;
myunit.ear</pre> 
       </div> 
      </div>
     </div> <p>Note - You can combine the steps to build and deploy the application into a single step by specifying the <tt>deploy</tt> argument to the generated build script. To use this option, modify the step in which you run the generated build script (Invoking the Migration Tool on Solaris and Linux, Invoking the Migration Tool on Windows) as follows:<br> On Solaris:</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">% sh build_ear.sh -Dw=&lt;passwordfile&gt; deploy</pre> 
       </div> 
      </div>
     </div> <p>On Windows:</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">PROMPT&gt; build_ear -Dw=&lt;passwordfile&gt; deploy</pre> 
       </div> 
      </div>
     </div> <p>The build scripts assume the following default values:</p> 
     <ul> 
      <li>username is "admin"</li> 
      <li>hostname is "localhost"</li> 
      <li>adminport is "4848"</li> 
     </ul> <p>You can override these default values with the following command:<br> On Solaris:</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">% sh build_ear.sh -Du=_&lt;username&gt;_ -DH=_&lt;hostname&gt;_ -Dp=_&lt;portno&gt;_ -Di=_&lt;instancename&gt;_ -Dw=_&lt;passwordfile&gt;_deploy</pre> 
       </div> 
      </div>
     </div> <p>On Windows:</p> 
     <div class="code panel" style="border-width: 1px;">
      <div class="codeContent panelContent"> 
       <div id="root"> 
        <pre class="theme: Confluence; brush: java; gutter: false">PROMPT&gt; sh build_ear.sh -Du=_&lt;username&gt;_ -DH=_&lt;hostname&gt;_ -Dp=_&lt;portno&gt;_ -Di=_&lt;instancename&gt;_ -Dw=_&lt;passwordfile&gt;_deploy</pre> 
       </div> 
      </div>
     </div> <p>If the Migration Tool generated the Migration Report file, you must specify an additional argument, <tt>-Dp=y</tt> along with the <tt>deploy</tt> argument. </p> <h4><a name="M2GPostRun-TroubleshootingtheBuildingandDeploymentProcesses"></a>Troubleshooting the Building and Deployment Processes</h2> <p>Problem: The build script is not generated in the output directory.<br> Description: The <tt>build_</tt><em>xxx</em> script is not in the output directory (where xxx refers to the JAR, WAR, RAR or EAR filename).</p> 
     <ul> 
      <li>Cause: The deployment descriptor file is not in the input directory.</li> 
      <li>Solution: Migrate the deployment descriptor file along with the source Java files and the build scripts will be generated.</li> 
     </ul> 
     <ul> 
      <li>Cause: The deployment descriptor file was not migrated successfully.</li> 
      <li>Solution: Fix the deployment descriptor file so that it can be migrated successfully and the build scripts can be generated.</li> 
     </ul> <p>Problem: The build script does not generate the archive file.<br> Description: Either a "BUILD FAILED" message is displayed or the build was never invoked.</p> 
     <ul> 
      <li>Cause: The required JAR files are not present in the CLASSPATH, so the source Java files do not get compiled.</li> 
      <li>Solution: Modify the CLASSPATH environment variable to include the JAR files that are required for compilation.</li> 
     </ul> 
     <ul> 
      <li>Cause: The directory does not have read/write permissions.</li> 
      <li>Solution: Modify the permissions of the directory to have read/write permission.</li> 
     </ul> 
     <ul> 
      <li>Cause: The DBSCHEMA variable is not set for a CMP entity bean present in the JAR file.</li> 
      <li>Solution: Set the DBSCHEMA variable to point to the location of the dbschema file.</li> 
     </ul> 
     <ul> 
      <li>Cause: The generated target deployment descriptors contain "REPLACEME" strings.</li> 
      <li>Solution: Replace all occurrences of "REPLACEME" with meaningful values.</li> 
     </ul> <p>Problem: The generated archive file does not get deployed.<br> Description: An exception is thrown when the migrated application is deployed to the Application Server.</p> 
     <ul> 
      <li>Cause: The <tt>application.xml</tt> file could contain module names that are not present in the EAR file.</li> 
      <li>Solution: Edit the <tt>application.xml</tt> file so it contains the names of the JAR and WAR files packaged in the EAR file. See the Migration Report section for more information.</li> 
     </ul> <p><a href="M2GRun.html" title="M2GRun">Previous</a> <a href="M2GCapabilties.html" title="M2GCapabilties">Next</a></p> 
     <hr> </td> 
   </tr> 
  </tbody>
 </table>    
</body></div>
        <br/>

        <!-- footer================================================== -->
        <footer class="well">
            <div class="container">

                <div class="row-fluid" id="bottom-info">
                    <!--div class="span6 pagination-centered" id="social"-->
                    <div class="span4" id="social">			
                        <a href="http://blogs.oracle.com/theaquarium/"><img src="../images/icons/TheAquarium.png"></a>
                        <a href="https://twitter.com/glassfish"><img src="../images/icons/twitter.png"></a>
                        <a href="https://plus.google.com/communities/106098646151660933759"><img src="../images/icons/google.png"></a>
                        <a href="http://www.linkedin.com/groups/GlassFish-Users-106819/about"><img src="../images/icons/linkedin.png"></a>
                        <a href="http://www.youtube.com/user/GlassFishVideos"><img src="../images/icons/youtube.png"></a>
                        <a href="https://www.facebook.com/GlassFish"><img src="../images/icons/facebook.png"></a>
                    </div>

                    <div class="span8" id="copyright">Page last changed on Jul 12, 2010 by 
<font color="#0050B2">am74686</font>. Exported from wikis.oracle.com on May 27, 2015 20:49.<br/>
                        Copyright &copy; 2005-2015 Oracle Corporation and/or its affiliates.</div>
                </div>
            </div>
        </footer>

        <!-- ================================================== -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/bootstrap-tab.js"></script>
	<script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<!--  Begin SiteCatalyst code  -->
  	<!--  End SiteCatalyst code  -->
    </body>
</html>