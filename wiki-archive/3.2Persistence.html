<!DOCTYPE html>
<html  xml:lang="en" lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>GlassFish Wiki : 3.2Persistence</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta http-equiv="content-language" content="en" />
        <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet" />
        <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
        <link href="styles/docs.css" rel="stylesheet" />
        <link href="styles/site1.css" rel="stylesheet" />
        <style> a { color: #555555; } </style>
        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
                <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>

    <body class="page-documentation project-gfmvnsite" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <div class="brand"><a href="/glassfish/index.html"><img src="../images/gflogo24.png"><span style="color:#E88A43;font-size:18px;padding-left:11px;padding-top:15px;font-weight:bold;">GlassFish</span> - <span style="font-size:18px;" class="gf-grey">World's first Java EE 7 Application Server</span></a></div>
                    <div class="nav-collapse">
                        <ul class="nav pull-right">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
									<li><a href="/glassfish/LICENSE" title="License">Legal </a></li>
									<li><a href="/glassfish/CONTRIBUTING" title="Contributing">Contributing </a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>

        <br/><br/>
        <div class="container"><body> 
 <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff"> 
  <tbody>
   <tr> 
    <td valign="top" class="pagebody">   
     <div> 
      <ul> 
       <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>GlassFish Server Open Source Edition 3.2 - Persistence &nbsp;One Pager</b></span></a></li> 
       <ul> 
        <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>1. Introduction</b></span></a></li> 
        <ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>1.1 Project/Component Working Name:</b></span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>1.2 Name and Email Address of Author</b></span></a></li> 
         <li><a href="#3.2Persistence-1.3.DateofThisDocument%3A"> <b>1.3. Date of This Document:</b></a></li> 
        </ul> 
        <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>2. Project Summary</b></span></a></li> 
        <ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>2.1. Project Description:</b></span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>2.2. Risks and Assumptions:</b></span></a></li> 
        </ul> 
        <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>3. Problem Summary</b></span></a></li> 
        <ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>3.1. Problem Area:</b></span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>3.2. Justification:</b></span></a></li> 
        </ul> 
        <li><a href="#3.2Persistence-4.TechnicalDescription%3A"> <b>4. Technical Description:</b></a></li> 
        <ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.1. Details:</b></span></a></li> 
         <ul> 
          <li><a href="#3.2Persistence-4.1.1%5C%26nbsp%3BEclipseLinksecondlevelcachecoordinationusingGMSastransportlayer"> <b>4.1.1 -&nbsp;EclipseLink second level cache coordination using GMS as transport layer</b></a></li> 
          <li><a href="#3.2Persistence-4.1.2IntegrateEclipseLinkmechanismtoprovideextensionsintoGlassFish"> <b>4.1.2 - Integrate EclipseLink mechanism to provide extensions into GlassFish</b></a></li> 
         </ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000">4.2. Bug/RFE Number:</span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000">4.4. In Scope:</span></a></li> 
         <li><a href="#3.2Persistence-4.5.Interfaces%3A">4.5. Interfaces:</a></li> 
         <ul> 
          <li><a href="#3.2Persistence-4.5.1PublicInterfaces">4.5.1 Public Interfaces</a></li> 
          <li><a href="#3.2Persistence-4.5.2PrivateInterfaces">4.5.2 Private Interfaces</a></li> 
          <li><a href="#3.2Persistence-4.5.3Deprecated%2FRemovedInterfaces%3A">4.5.3 Deprecated/Removed Interfaces:</a></li> 
         </ul> 
         <li><a href="#3.2Persistence-4.6.DocImpact%3A">4.6. Doc Impact:</a></li> 
         <li><a href="#3.2Persistence-4.7.Admin%2FConfigImpact%3A">4.7. Admin/Config Impact:</a></li> 
         <li><a href="#3.2Persistence-4.8.HAImpact%3A">4.8. HA Impact:</a></li> 
         <li><a href="#3.2Persistence-4.9.I18N%2FL10NImpact%3A"> <b>4.9. I18N/L10N Impact:</b></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.10. Packaging, Delivery &amp; Upgrade:</b></span></a></li> 
         <ul> 
          <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.10.1. Packaging</b></span></a></li> 
          <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.10.2. Delivery</b></span></a></li> 
          <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.10.3. Upgrade and Migration:</b></span></a></li> 
         </ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.11. Security Impact:</b></span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.12. Compatibility Impact</b></span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.13. Dependencies:</b></span></a></li> 
         <ul> 
          <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.13.1 Internal Dependencies</b></span></a></li> 
          <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.13.2 External Dependencies</b></span></a></li> 
         </ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>4.14. Testing Impact:</b></span></a></li> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>5. Reference Documents:</b></span></a></li> 
        </ul> 
        <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>6. Schedule:</b></span></a></li> 
        <ul> 
         <li><a href="#3.2Persistence-"> <span style="color: #000000"><b>6.1. Projected Availability:</b></span></a></li> 
        </ul> 
       </ul> 
      </ul>
     </div> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>GlassFish Server Open Source Edition 3.2 - Persistence &nbsp;One Pager</b></font></h1> <p><font color="inherit">(template version 1.92)</font></p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>1. Introduction</b></font></h2> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>1.1 Project/Component Working Name:</b></font></h3> <p><font color="inherit">GlassFish Server Open Source Edition 3.2 Persistence Service&nbsp;</font>improvements</p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>1.2 Name and Email Address of Author</b></font></h3> <p><ins><a href="mailto:mitesh.meswani@oracle.com">Mitesh Meswani</a></ins></p> <h4><a name="3.2Persistence-1.3.DateofThisDocument%3A"></a><b>1.3. Date of This Document:</b></h3> <p><font color="inherit">Started: 04/25/11</font></p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>2. Project Summary</b></font></h2> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>2.1. Project Description:</b></font></h3> <p><font color="inherit">GlassFish Persistence Services Improvements. These improvements will enable GlassFish persistence service to function more efficiently in a PaaS environment. Following improvements to persistence service are targeted for GlassFish 3.2</font></p> 
     <ul> 
      <li>EclipseLink second level cache coordination using GMS as transport layer</li> 
      <li>Integrate EclipseLink mechanism to provide extensions into GlassFish</li> 
     </ul> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>2.2. Risks and Assumptions:</b></font></h3> 
     <ul> 
      <li>EclipseLink second level cache coordination using GMS as transport layer 
       <ul> 
        <li>GMS API will work and scale as expected</li> 
       </ul> </li> 
      <li>Integrate EclipseLink mechanism to provide extensions into GlassFish 
       <ul> 
        <li>This feature is still being defined by EclipseLink team. It may not evolve into a shape that enables appservers to leverage it.</li> 
       </ul> </li> 
     </ul> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>3. Problem Summary</b></font></h2> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>3.1. Problem Area:</b></font></h3> <p>Improve GlassFish persistence service to function more efficiently in a PaaS environment</p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>3.2. Justification:</b></font></h3> <p><font color="#000000">Persistence, a core service for GlassFish need to function efficiently in a PaaS environment</font></p> <h4><a name="3.2Persistence-4.TechnicalDescription%3A"></a><b>4. Technical Description:</b></h2> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.1. Details:</b></font></h3> <h4><a name="3.2Persistence-4.1.1%5C%26nbsp%3BEclipseLinksecondlevelcachecoordinationusingGMSastransportlayer"></a><b>4.1.1 -&nbsp;EclipseLink second level cache coordination using GMS as transport layer</b></h4> <p>EclipseLink is the default persistence provider for GlassFish. In a clustered deployment, having EclipseLink's second level cache synchronized between nodes of a cluster should reduce probability of rollback due to stale data and thus improve throughput. EclipseLink provides a mechasnim to write plugin that hooks into second level cache events. &nbsp;Goal of this project will be to implement this plugin using GMS as transport. Here are details of the planned implementation.</p> 
     <ul> 
      <li>User can indicate that a Persistence Unit requires second level cache coordination using GMS by adding property "eclipselink.cache.coordination.protocol" with value "GMS" for a given persistence unit.</li> 
      <li>For such persistence units, &nbsp;at app deployment a message listener will be registered with GMS. The API used is &nbsp; 
       <div class="preformatted panel" style="border-width: 1px;">
        <div class="preformattedContent panelContent"> 
         <pre>GMSAdapter.registerMessageListener(String&nbsp;componentName, CallBack&nbsp;messageListener)
</pre> 
        </div>
       </div> <p>Where componentName will be derived by combining ApplicationName + ModuleName + PuName. This ensures a unique channel per pu being deployed</p></li> 
      <li>At transaction commit, changes made in the transaction will be transmitted to the GMS group. The GMS API used for this will be 
       <div class="preformatted panel" style="border-width: 1px;">
        <div class="preformattedContent panelContent"> 
         <pre>GroupManagementService.getGroupHandle().sendMessage(componentName,&nbsp;byte[]&nbsp;message)
</pre> 
        </div>
       </div> <p>Where componentName will be derived as stated above and message will be constructed by serializing EclipseLink change set that represents changes made in the transaction into a byte[]</p></li> 
     </ul> 
     <ul> 
      <li>The message listener, on &nbsp;receiving &nbsp;the message will apply the received change set to the second level cache at destination&nbsp;</li> 
     </ul> <h4><a name="3.2Persistence-4.1.2IntegrateEclipseLinkmechanismtoprovideextensionsintoGlassFish"></a><b>4.1.2 - Integrate EclipseLink mechanism to provide extensions into GlassFish</b></h4> <p>EclipseLink team is defining&nbsp;<a href="http://wiki.eclipse.org/EclipseLink/DesignDocs/340192">feature</a> that will enable providing extensions to a given entity. &nbsp;This feature can be leveraged to provision MultiTenant apps into GlassFish such that each tenant can customize set of attributes for entities. The goal of this project will be to integrate this feature into GlassFish. Details will be added to this section once the EclipseLink feature solidifies.&nbsp;</p> <p>Both the features above will introduce compile time dependency on EclipseLink. A separate module parallel to jpa-connector will be created to host code that depends on EclipseLink</p> <h4><a name="3.2Persistence-"></a><font color="#000000">4.2. Bug/RFE Number:</font></h3> <h4><a name="3.2Persistence-"></a><font color="#000000">4.4. In Scope:</font></h3> 
     <ul> 
      <li>Features described above</li> 
      <li>Work resulting from&nbsp;**<a href="./3.2DeploymentOnePager#3.2DeploymentOnePager-AdHocclusterdeployment%3A.html">Ad Hoc Cluster Deployment</a><br> * Potential work resulting from <a href="http://www.jcp.org/en/jsr/detail-338">JSR 338</a>(Java Persistence 2.1)<br> * Work resulting from MultiTenancy<br> * Integrate EclipseLink 2.3<br> * On going maintenance to persistence code<br> 4.4. Out of Scope:</li> 
      <li>Any features not mentioned above</li> 
     </ul> <h4><a name="3.2Persistence-4.5.Interfaces%3A"></a>4.5. Interfaces:</h3> <h4><a name="3.2Persistence-4.5.1PublicInterfaces"></a>4.5.1 Public Interfaces</h4> <p>interface : javax.persistence (ver 2.1)</p> <p>comments : From JSR 338</p> <h4><a name="3.2Persistence-4.5.2PrivateInterfaces"></a>4.5.2 Private Interfaces</h4> <p>No new private interfaces that are observable externally.</p> <h4><a name="3.2Persistence-4.5.3Deprecated%2FRemovedInterfaces%3A"></a>4.5.3 Deprecated/Removed Interfaces:</h4> <p>None.</p> <h4><a name="3.2Persistence-4.6.DocImpact%3A"></a>4.6. Doc Impact:</h3> <p>New documentation will be required to explain both 4.1.1 and 4.1.2</p> <h4><a name="3.2Persistence-4.7.Admin%2FConfigImpact%3A"></a>4.7. Admin/Config Impact:</h3> <p>None.</p> <h4><a name="3.2Persistence-4.8.HAImpact%3A"></a>4.8. HA Impact:</h3> <p>Feature 4.1.1 will introduce more network traffic when cache coordination is turned on. This may impact HA performance.&nbsp;</p> <h4><a name="3.2Persistence-4.9.I18N%2FL10NImpact%3A"></a><b>4.9. I18N/L10N Impact:</b></h3> <p><font color="inherit">No impact.</font></p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.10. Packaging, Delivery &amp; Upgrade:</b></font></h3> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.10.1. Packaging</b></font></h4> <p>A new module that represents code having dependency on EclipseLink will be introduced. This module needs to be shipped with GlassFish.</p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.10.2. Delivery</b></font></h4> <p><font color="inherit">No impact.</font></p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.10.3. Upgrade and Migration:</b></font></h4> <p><font color="inherit">No backward compatibility issues.&nbsp;</font></p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.11. Security Impact:</b></font></h3> <p>Like any other GMS communication in GlassFish, the change set being&nbsp;broadcasted&nbsp;may be intercepted.</p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.12. Compatibility Impact</b></font></h3> <p>None</p> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.13. Dependencies:</b></font></h3> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.13.1 Internal Dependencies</b></font></h4> 
     <ul> 
      <li>GMS</li> 
     </ul> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.13.2 External Dependencies</b></font></h4> 
     <ul> 
      <li>EclipseLink v2.3</li> 
     </ul> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>4.14. Testing Impact:</b></font></h3> 
     <ul> 
      <li>New automated tests should be developed by SQE to test the cache coordination feature</li> 
     </ul> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>5. Reference Documents:</b></font></h3> 
     <ul> 
      <li><a href="http://wiki.eclipse.org/EclipseLink/Development/2.3">EclipseLink 2.3 development plans</a> &nbsp;</li> 
     </ul> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>6. Schedule:</b></font></h2> <h4><a name="3.2Persistence-"></a><font color="#000000"><b>6.1. Projected Availability:</b></font></h3> </td> 
   </tr> 
  </tbody>
 </table>    
</body></div>
        <br/>

        <!-- footer================================================== -->
        <footer class="well">
            <div class="container">

                <div class="row-fluid" id="bottom-info">
                    <!--div class="span6 pagination-centered" id="social"-->
                    <div class="span4" id="social">			
                        <a href="http://blogs.oracle.com/theaquarium/"><img src="../images/icons/TheAquarium.png"></a>
                        <a href="https://twitter.com/glassfish"><img src="../images/icons/twitter.png"></a>
                        <a href="https://plus.google.com/communities/106098646151660933759"><img src="../images/icons/google.png"></a>
                        <a href="http://www.linkedin.com/groups/GlassFish-Users-106819/about"><img src="../images/icons/linkedin.png"></a>
                        <a href="http://www.youtube.com/user/GlassFishVideos"><img src="../images/icons/youtube.png"></a>
                        <a href="https://www.facebook.com/GlassFish"><img src="../images/icons/facebook.png"></a>
                    </div>

                    <div class="span8" id="copyright">Page last changed on Apr 25, 2011 by 
<font color="#0050B2">mitesh_m</font>. Exported from wikis.oracle.com on May 27, 2015 20:47.<br/>
                        Copyright &copy; 2005-2015 Oracle Corporation and/or its affiliates.</div>
                </div>
            </div>
        </footer>

        <!-- ================================================== -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/bootstrap-tab.js"></script>
	<script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<!--  Begin SiteCatalyst code  -->
  	<!--  End SiteCatalyst code  -->
    </body>
</html>